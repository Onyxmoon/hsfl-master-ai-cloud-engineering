services:
  proxy:
    image: onyxmoon/pw-http-proxy-service:latest
    environment:
      - PROXY_DOCKER_CONFIG_PATH=./config
      - PROXY_DOCKER_CONFIG_FILENAME=proxyConfig.docker.native.yaml
    ports:
      - 8080:8080
      - 443:8443
    depends_on:
      - web
    networks:
      - public
      - internal

  web:
    image: onyxmoon/pw-web-service:latest
    ports:
      - 3000:3000
    depends_on:
      - products
      - shoppinglists
      - users
    networks:
      - internal

  products:
    image: onyxmoon/pw-product-service:latest
    ports:
      - 3003:3003
    networks:
      - internal

  users:
    image: onyxmoon/pw-user-service:latest
    ports:
      - 3001:3001
    networks:
      - internal

  shoppinglists:
    image: onyxmoon/pw-shoppinglist-service:latest
    ports:
      - 3002:3002
    networks:
      - internal


networks:
  public:
    driver: bridge
  internal:
    driver: bridge
    internal: true